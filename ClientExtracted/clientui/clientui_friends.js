/*!
 * (c) Valve Corporation. Use is governed by the terms of the Steam Subscriber Agreement http://store.steampowered.com/subscriber_agreement/. 
 * 
 */
webpackJsonp([7],{0:function(e,t,i){e.exports=i("afSG")},ClTo:function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i("TToO"),a=i("GiK3"),o=(i.n(a),i("5Pz3")),r=i("KLxG"),s="c:\\buildslave\\steam_webpack_rel_client_win32\\build\\src\\clientui\\shared\\js\\ui\\titlebar.tsx",l=function(e){function t(t){var i=e.call(this,t)||this;return i.state={maximized:i.BIsMaximized()},i}return n.d(t,e),t.prototype.BIsMaximized=function(){var e=this.props.popup.screen.availWidth-this.props.popup.innerWidth,t=this.props.popup.screen.availHeight-this.props.popup.innerHeight;return 0===e&&0===t},t.prototype.componentDidMount=function(){this.props.popup.addEventListener("resize",this.UpdateMaximizeState)},t.prototype.componentWillUnmount=function(){this.props.popup.removeEventListener("resize",this.UpdateMaximizeState)},t.prototype.UpdateMaximizeState=function(){var e=this.BIsMaximized();e!=this.state.maximized&&this.setState({maximized:e})},t.prototype.render=function(){var e=this.props.popup,t=function(){e&&e.close()},i=function(){e.SteamClient.Window.ToggleMaximize()},n=function(){e.SteamClient.Window.Minimize()},r="title-area-icon";return this.state.maximized?r+=" restoreButton":r+=" maximizeButton",a.createElement("div",{className:"TitleBar title-area",__source:{fileName:s,lineNumber:45}},a.createElement("div",{className:"title-area-highlight",__source:{fileName:s,lineNumber:46}}),a.createElement("div",{className:"title-area-children",__source:{fileName:s,lineNumber:47}},this.props.children),!this.props.hideActions&&a.createElement("div",{className:"title-bar-actions",__source:{fileName:s,lineNumber:51}},a.createElement("div",{className:"title-area-icon closeButton",onClick:t,__source:{fileName:s,lineNumber:52}},a.createElement(o.k,{__source:{fileName:s,lineNumber:52}})),!this.props.hideMinMax&&a.createElement("div",{className:r,onClick:i,__source:{fileName:s,lineNumber:53}},this.state.maximized&&a.createElement(o.g,{__source:{fileName:s,lineNumber:55}}),!this.state.maximized&&a.createElement(o.e,{__source:{fileName:s,lineNumber:57}})),!this.props.hideMinMax&&a.createElement("div",{className:"title-area-icon minimizeButton",onClick:n,__source:{fileName:s,lineNumber:59}},a.createElement(o.f,{__source:{fileName:s,lineNumber:59}}))))},n.c([r.a],t.prototype,"UpdateMaximizeState",null),t}(a.Component)},KxOm:function(e,t,i){"use strict";i.d(t,"a",function(){return b});var n=i("TToO"),a=i("y986"),o=i("Mn8c"),r=i("GiK3"),s=(i.n(r),i("O27J")),l=(i.n(s),i("z9An")),c=i("sVhq"),m=i("ccMP"),u=i("KLxG"),d=i("ClTo"),p=i("5Pz3"),h=i("sgqT"),f="c:\\buildslave\\steam_webpack_rel_client_win32\\build\\src\\clientui\\ui\\src\\js\\components\\friends.tsx",_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.d(t,e),t.prototype.ContextMenu=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.OnRetryClick=function(){console.log("OnRetryClick"),window.parent.postMessage({message:"ChatReloadRequest",state:void 0},"https://steamloopback.host")},t.prototype.SetNotWorking=function(){this.m_bStillWorking=!1},t.prototype.componentDidMount=function(){var e=this;this.m_bStillWorking=this.props.stillLoading,this.m_msLeftUntilFailure=this.props.msLeft,this.m_bStillWorking&&setTimeout(this.SetNotWorking,this.m_msLeftUntilFailure),"undefined"!=typeof SteamClient&&SteamClient.WebChat&&SteamClient.WebChat.GetLocalPersonaName&&SteamClient.WebChat.GetLocalPersonaName().then(function(t){e.m_strPersonaName=t}),"undefined"!=typeof SteamClient&&SteamClient.WebChat&&SteamClient.WebChat.GetLocalAvatarBase64&&SteamClient.WebChat.GetLocalAvatarBase64().then(function(t){e.m_strAvatarSource=t})},t.prototype.render=function(){var e="chat_main fullheight responsive_friends friends_loading_error";this.m_bStillWorking&&(e+=" still_loading");var t=this.m_strPersonaName,i=this.m_strAvatarSource,n="currentUserAvatar";return""==i&&(n+=" noAvatarImg"),this.props.popup&&this.props.popup.focused&&(e+=" focused"),r.createElement("div",{className:e,onContextMenu:this.ContextMenu,__source:{fileName:f,lineNumber:61}},r.createElement("div",{className:"friendsListContainer fullheight",__source:{fileName:f,lineNumber:62}},r.createElement("div",{className:"friendlist",__source:{fileName:f,lineNumber:63}},r.createElement(d.a,{popup:this.props.popup.window,__source:{fileName:f,lineNumber:64}}),r.createElement("div",{className:"currentUserContainer",__source:{fileName:f,lineNumber:65}},r.createElement("div",{className:"AvatarAndUser",__source:{fileName:f,lineNumber:66}},""!=i&&r.createElement("img",{className:n,src:i,__source:{fileName:f,lineNumber:68}}),""==i&&r.createElement("div",{className:n,__source:{fileName:f,lineNumber:70}}),r.createElement("div",{className:"labelHolder",__source:{fileName:f,lineNumber:71}},r.createElement("div",{className:"statusAndName",__source:{fileName:f,lineNumber:72}},r.createElement("div",{className:"playerName",__source:{fileName:f,lineNumber:73}},t)),r.createElement("div",{className:"richPresenceContainer",__source:{fileName:f,lineNumber:75}},r.createElement("div",{className:"gameName richPresenceLabel",__source:{fileName:f,lineNumber:76}},Object(c.b)("#FriendsList_Offline_Disconnected")))))),r.createElement("div",{className:"FriendsFailureContainer",__source:{fileName:f,lineNumber:81}},r.createElement("div",{className:"friendsListInsetShadowCtn",__source:{fileName:f,lineNumber:82}},r.createElement("div",{className:"frienListInsetShadowTop",__source:{fileName:f,lineNumber:83}})),this.m_bStillWorking?r.createElement("div",{__source:{fileName:f,lineNumber:86}},r.createElement(h.a,{className:"friendsThrobber",size:"large",string:Object(c.b)("#FriendsList_StillLoadingSummary"),position:"center",__source:{fileName:f,lineNumber:87}})):r.createElement("div",{className:"cautionIcon",__source:{fileName:f,lineNumber:85}},r.createElement(p.a,{__source:{fileName:f,lineNumber:85}})),r.createElement("div",{className:"summaryText",__source:{fileName:f,lineNumber:89}},!this.m_bStillWorking&&Object(c.b)("#FriendsList_OfflineOrFailure")),r.createElement("div",{className:"detailText",__source:{fileName:f,lineNumber:92}},this.m_bStillWorking?Object(c.b)("#FriendsList_StillLoadingDetail"):Object(c.b)("#FriendsList_OfflineDetail")),!this.m_bStillWorking&&r.createElement("div",{__source:{fileName:f,lineNumber:96}},r.createElement("button",{className:"retryButton",onClick:this.OnRetryClick,__source:{fileName:f,lineNumber:97}},Object(c.b)("#Friends_RetryLoading"))))),r.createElement(m.a,{popup:this.props.popup.window,__source:{fileName:f,lineNumber:101}})))},n.c([a.observable],t.prototype,"m_bStillWorking",void 0),n.c([a.observable],t.prototype,"m_msLeftUntilFailure",void 0),n.c([a.observable],t.prototype,"m_strPersonaName",void 0),n.c([a.observable],t.prototype,"m_strAvatarSource",void 0),n.c([u.a],t.prototype,"ContextMenu",null),n.c([u.a],t.prototype,"OnRetryClick",null),n.c([u.a],t.prototype,"SetNotWorking",null),t=n.c([o.observer],t)}(r.Component),b=function(e){function t(t,i){var n=this,a={dimensions:{width:300,height:650},minWidth:226,minHeight:400,title:Object(c.b)("#WindowTitle_FriendsList"),html_class:"client_chat_frame fullheight SavedDimensionsPopup",body_class:"fullheight",target_browser:void 0,eCreationFlags:l.c.Resizable};return n=e.call(this,"friendslist","PopupFriendsListDimensions",a,!1)||this,n.m_bStillWorking=t,n.m_msLeftUntilFailure=i,n}return n.d(t,e),t.prototype.Render=function(e,t){t.setAttribute("class","fullheight popup_chat_frame"),s.render(r.createElement(_,{popup:this,stillLoading:this.m_bStillWorking,msLeft:this.m_msLeftUntilFailure,__source:{fileName:f,lineNumber:156}}),t)},t.prototype.OnClose=function(){e.prototype.OnClose.call(this)},t}(l.b)},afSG:function(e,t,i){"use strict";function n(e){return"undefined"!=typeof SteamClient&&SteamClient.WebChat&&SteamClient.WebChat.RegisterForFriendPostMessage&&SteamClient.WebChat.RegisterForFriendPostMessage(d),void 0!==S&&(clearInterval(S),S=void 0),M?(W=!1,v=e,k=performance.now(),L=1e7,void p(!1)):O?(W=!1,v=e,k=performance.now(),L=1e7,void p(!0)):(W=!1,z=0,v=e,k=performance.now(),void 0!==g&&clearTimeout(g),void 0!==C&&clearTimeout(C),C=setTimeout(s,4e3),g=setTimeout(r,1e3),L=1e3,void SteamClient.WebChat.GetWebChatURL().then(function(e){console.log("Loading chat from url: ",e),N=e,void 0!==g&&clearTimeout(g),a(e)}))}function a(e){console.log("Checking network... "+y);var t=7500;0==y?(k=performance.now(),L=1e4,t=500):1==y&&(t=2e3);var i=e;++y,_.a.head(e,{timeout:t}).then(function(e){void 0===e.headers["x-buildtimestamp"]&&console.log("Network check (head req) got 200, but no x-buildtimestamp, not valid? Proceeding anyway..."),console.log("Network check (head req) passed after "+y+" tries..."),o(i)}).catch(function(e){console.log("Network check try "+y+" failed..."),y>=3?p(!1):a(i)})}function o(e){console.log("Loading chat from url: ",e),void 0!==g&&clearTimeout(g),k=performance.now(),L=15e3,g=setTimeout(r,15e3),document.getElementById(v).src=e}function r(){console.log("Failed to load chat!"),g=void 0,w++,p(!1)}function s(){W||p(!0),C=void 0}function l(){void 0!=E&&(console.log("Closing error dialog"),E.Close(),E=void 0)}function c(e){if("object"==typeof e.data&&void 0!=e.data.message)if("ShowFriendsErrorRetryDialog"==e.data.message){void 0!==g&&(clearTimeout(g),g=void 0);var t=document.getElementById(v);t&&void 0!=t.src&&(t.src=void 0),W=!1,p(!1)}else if("ChatJavascriptInitialized"==e.data.message){if(W=!0,void 0!==g&&clearTimeout(g),z=void 0!==e.data.data?e.data.data:0,void 0!=T)try{var i=N.match(/(https:\/\/[^\/]+)\/.*/)[1];window.frames[0].postMessage({message:"ReloadSerializedChatState",state:T},i),T=void 0}catch(e){console.log("Failed trying to ask FriendsUI to restore chat state after reload"),T=void 0}S=setInterval(m,1e3*F),l(),g=void 0,w=0,console.log("Chat loaded! "+z)}else if(void 0!=e.data.message&&"ChatReloadRequest"==e.data.message){if(void 0==v||""==v)return;y=0,l(),void 0!=e.data.state&&(T=e.data.state),n(v)}else"CheckForAndForceUpdate"==e.data.message&&u(!0)}function m(){u(!1)}function u(e){SteamClient.WebChat.GetWebChatURL().then(function(t){console.log("Checking for updates from chat from url: ",t),void 0!==g&&clearTimeout(g),_.a.head(t,{timeout:1e4}).then(function(i){if(void 0!==i.headers["x-buildtimestamp"]){x=Number(i.headers["x-buildtimestamp"]),console.log("Currently available build: "+x);var n=86400;if(e&&(n=0),0!=x&&0!=z){var a=x-z;if(W&&a>n){var o=a>604800,r=Number(i.headers["x-forceuiupdate"])||e;console.log("We are out of date enough to reload if idle, bVeryOutOfDate="+(o?"true":"false"));var s=t.match(/(https:\/\/[^\/]+)\/.*/)[1];window.frames[0].postMessage({message:"UpdatedBuildAvailable",bVeryOutOfDate:o,bForce:r,nSecondsOutOfDate:a},s)}}}}).catch(function(e){console.log("Failed trying to check available build timestamp")})})}function d(e){var t=e.data;t&&t.command&&"ShowPopupFriendsList"==t.command&&(console.log("ShowPopupFriendsList"),void 0!=E?E.Show(!0):W||p(!0))}function p(e){console.log("ShowFailureDialog "+(e?"true":"false")),0==e&&void 0!==g&&(clearTimeout(g),g=void 0),void 0==E&&(E=new h.a(e,L-(performance.now()-k)),E.Show())}Object.defineProperty(t,"__esModule",{value:!0});var h=i("KxOm"),f=i("mtWM"),_=i.n(f),b=i("9YjS");window._Steam={onComponentMounted:b.c},window.test=b.b;var v="",N="",g=void 0,C=void 0,S=void 0,w=0,y=0,E=void 0,W=!1,k=0,L=1e4,z=0,x=0,T=void 0,F=14400,M=!1,O=!1;window.addEventListener("message",c),document.addEventListener("DOMContentLoaded",function(){SteamClient.WebChat.GetWebChatLanguage().then(function(e){Object(b.a)(e).then(function(){n("tracked_frame_friends_chat")}).catch(function(){console.log("Failed to load localization!"),n("tracked_frame_friends_chat")})})})},ccMP:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("TToO"),a=i("GiK3"),o=(i.n(a),function(e){function t(t){var i=e.call(this,t)||this;return i.m_fnExistingPopupInitializer=void 0,i.BindResizeGrip=i.BindResizeGrip.bind(i),i}return n.d(t,e),t.prototype.BindResizeGrip=function(e){var t=0,i=0;if(e){var n=e.getBoundingClientRect(),a=e.ownerDocument.defaultView;n&&a&&(t=Math.ceil(a.innerWidth-n.left),i=Math.ceil(a.innerHeight-n.top))}var o=this.props.popup;o.SteamClient&&o.SteamClient.Window&&o.SteamClient.Window.SetResizeGrip&&o.SteamClient.Window.SetResizeGrip(t,i)},t.prototype.componentWillUnmount=function(){this.props.popup.SteamClient.Window.SetResizeGrip(0,0)},t.prototype.render=function(){return a.createElement("div",{className:"window_resize_grip",ref:this.BindResizeGrip,__source:{fileName:"c:\\buildslave\\steam_webpack_rel_client_win32\\build\\src\\clientui\\shared\\js\\ui\\windowresizegrip.tsx",lineNumber:33}})},t}(a.PureComponent))},sgqT:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("TToO"),a=i("GiK3"),o=(i.n(a),i("5Pz3")),r="c:\\buildslave\\steam_webpack_rel_client_win32\\build\\src\\clientui\\shared\\js\\ui\\throbber.tsx",s=function(e){function t(t){return e.call(this,t)||this}return n.d(t,e),t.prototype.AddSizeClass=function(e){"small"==this.props.size?e.push("throbber_small"):"medium"==this.props.size?e.push("throbber_medium"):e.push("throbber_large")},t.prototype.render=function(){var e=["LoadingWrapper SteamLogoThrobber"];this.AddSizeClass(e),void 0===this.props.string&&e.push("noString"),this.props.className&&e.push(this.props.className);var t=a.createElement("div",{className:e.join(" "),__source:{fileName:r,lineNumber:25}},a.createElement("div",{className:"Throbber",__source:{fileName:r,lineNumber:26}},a.createElement(o.h,{className:"base",__source:{fileName:r,lineNumber:27}}),a.createElement(o.h,{className:"blur",__source:{fileName:r,lineNumber:28}})),a.createElement("div",{className:"ThrobberText",__source:{fileName:r,lineNumber:30}},this.props.string));return"center"==this.props.position&&(t=a.createElement("div",{className:"throbber_center_wrapper",__source:{fileName:r,lineNumber:34}},t)),t},t}(a.PureComponent)}});
//# sourceMappingURL=clientui_friends.js.map